---
title: "Analisis del IDH de Mexico"
author: Iván Montiel Cardona
date: 05/02/21
output: html_document
---

Para realizar este analisis se utilizo un dataset provisto por el [UNDP](http://hdr.undp.org/)

<br/>
<br/>

Lectura de las librerias
```{r}
library(ggplot2)
library(dplyr)
```

Para comenzar se cargo el dataset correspondiente a los Indices de Desarrollo Humano por pais, desde el año `1990` hasta `2019` en una variable de nombre `data`
```{r echo = FALSE}
data <- read.csv("https://raw.githubusercontent.com/Team-17-Bedu/proyecto/main/datasets/HDI_clean.csv?token=AIWFNPYBE3IFIBCN7L5RHXTADXTQG")
```

Posteriormente se seleccionó unicamente la fila que contiene los datos de México
```{r}
MEX <- data[data$Country == "Mexico", 4:length(data)]
MEX
```
Se trasponen los datos resultantes para añadir una columna con los años correspondientes al IDH
```{r}
MEX <- t(MEX)
MEX <- as.data.frame(cbind(1990:2019, MEX))
# Cambio de nombre de columnas
colnames(MEX) <- c("Year", "IDH")
```

La grafica de puntos resultante es
```{r}
ggplot(MEX, aes(x=Year, y = IDH)) +
  geom_point()  # Tipo de geometría, intenta utilizar alguna otra
```

Generación del modelo de regresión lineal
```{r}
attach(MEX)
m1 <- lm(IDH ~ Year)
summary(m1)
```

Gráfica de los datos junto con el modelo de regresión lineal
```{r}
plot(Year, IDH, xlab = "Año",
     ylab = "IDH", pch = 16)
abline(lsfit(Year, IDH))
```
Encontramos el cuantil de orden 0.975
```{r}
tval <- qt(1-0.05/2, 28)
tval
```
Comprobamos
```{r}
pt(tval, df = 28)
```
Encontramos intervalos de confianza del 95% para el intercepto y la pendiente
```{r}
round(confint(m1, level = 0.95), 3)
```
Se definen algunos posibles valores a estimar
```{r}
Year0 <- c(1990, 1994, 1998, 2002, 2006, 2010, 2014, 2018)
```


Gráfica de los datos, el modelo de regresion lineal y sus intervalos de confianza
```{r}
plot(Year, IDH, xlab = "Año",
     ylab = "IDH", pch = 16)
abline(lsfit(Year, IDH))

(conf <- predict(m1, newdata =
                   data.frame(Year = Year0),
                 interval = "confidence", level = 0.95))

lines(Year0, conf[, 2], lty = 2, lwd = 2, col = "green") # límites inferiores
lines(Year0, conf[, 3], lty = 2, lwd = 2, col = "green") # límites superiores

(pred <- predict(m1, newdata =
          data.frame(Year = Year0),
        interval = "prediction", level = 0.95))

lines(Year0, pred[, 2], lty = 2, lwd = 2, col = "blue") # límites inferiores
lines(Year0, pred[, 3], lty = 2, lwd = 2, col = "blue") # límites superiores
```
